# 第一需求概要

## 项目概述
开发一个微信小程序，允许用户使用微信账号登录，设置额定日薪及工作时间，并记录实际工作情况，计算工资。

## 功能模块

### 用户认证
- **微信登录**：用户通过微信账号登录小程序，确保数据的安全性和便捷性。
  - 使用微信提供的登录API
  - 获取用户的openId并存储在数据库中
- **本地登录**：用户可以选择使用本地账号（用户名和密码）登录。
  - 用户名和密码的注册与登录

### 用户设置
- **设置额定日薪**：用户可以输入每日期望的工资金额。
- **设置工作时间**：
  - 额定上班时间
  - 额定下班时间
- **计算额定时薪**：根据额定日薪和额定工时自动计算时薪，并存储在数据库中。
  - 计算公式：额定时薪 = 额定日薪 / (额定下班时间 - 额定上班时间)
  - 额定工时 = 额定下班时间 - 额定上班时间

### 打卡功能
- **上班打卡**：
  - 记录实际打卡时间
  - 计算当前工时
  - 计算已获得的工资金额
  - 计算当前时薪（额定日薪 / 实际工时）
- **下班打卡**：
  - 记录实际打卡时间
  - 记录当天总工时
  - 计算应获取的工资金额（当天工时 * 额定时薪）
  - 计算实际时薪（额定日薪 / 工时）

### 数据记录
记录以下信息到数据库：
- 额定上班时间
- 额定下班时间
- 实际上班打卡时间
- 实际下班打卡时间
- 额定时薪
- 实际时薪
- 额定工时
- 实际工时
- 预期工资金额
- 额定日薪

### 数据展示
- **日历视图**：以热力图形式展示每天的时薪或工时。
  - 颜色深浅代表工时多寡及时薪高低。
  - 用户可以选择查看时薪或工时的热力图

## 技术架构
- **前端**：使用 Taro 框架开发微信小程序，确保跨平台兼容性和高效开发。
- **后端**：采用 Node.js + Express 构建服务器，处理业务逻辑和数据存储。
- **数据库**：使用 PostgreSQL 存储用户数据和打卡记录，保证数据的结构化和可靠性。

## 数据流图
1. 用户登录 -> 设置日薪和工作时间 -> 存储设置到数据库
2. 用户打卡 -> 记录时间 -> 计算工时和工资 -> 更新数据库
3. 数据展示 -> 从数据库读取数据 -> 在前端展示热力图

## 非功能需求
- **安全性**：
  - 确保用户数据的隐私和安全，采用微信提供的认证机制。
  - 使用HTTPS进行数据传输
  - 对敏感数据进行加密存储
- **扩展性**：设计模块化，便于后续功能的扩展（如第二期需求）。
- **性能**：
  - 优化数据查询和计算，确保小程序的响应速度。
  - 使用数据库索引提高查询效率
  - 考虑使用缓存机制减少数据库访问